---
title: illusion
date: 2022-09-14
description: 在 Minecraft 设计实现非对称竞技游戏
endDate: present
cover: https://image.im0o.top/2025/202505181013717.webp
tags:
  - illusion#F49D37
  - Minecraft#7FB069
link: https://illusion.im0o.top
top: false
draft: false
weight: 5
no_ai: false
abbrlink: b5b531f7
---

## 项目背景

![](https://image.im0o.top/2024/202504282218906.png)

illusion 是一个以非对称竞技为核心机制的原创 Minecraft 对抗地图。

玩家在迷幻而危险的空间中分为 `逃生者` 和 `杀手` 两个阵营，展开紧张而富有策略性的对局。

---

我是一个非对称竞技游戏爱好者，同时也是一名 Minecraft 玩家。

早在 2019 年 4 月，我首次在 Minecraft 1.12.2 版本中尝试实现非对称玩法，开启了一个名为「彼岸花开」的地图项目（v0.1.0）。这个版本试图还原《黎明杀机》的机制，具备特殊血量系统、倒地机制、上钩系统，并通过玩家将末影之眼放入传送门模拟“发电机”互动，也奠定了后来“供奉箱”的机制原型。

![](https://image.im0o.top/2024/202505120223854.webp)

不过，该项目在 2020 年初因缺乏持续推进而暂停，未能实现完整玩法。

---

到了 2021 年，我认识了一位同样热爱非对称竞技玩法的 Minecraft 玩家。得知他在网易我的世界基岩版中也尝试还原类似机制后，我们合作开发了一个新地图，命名相当随意，叫作「网易鬼抓人」（v0.2.0）。

![](https://image.im0o.top/2024/202505120137614.png)
![](https://image.im0o.top/2024/202505120137670.png)

在这个版本中，我们做出了很多有趣的尝试，例如唯一区块随机生成机制等，已初步具备现在 illusion 的核心玩法雏形。虽然整体设计尚不规范，但作为我们私下游玩的项目，已经非常有趣。

可惜后来由于存档丢失，该版本最终也遗憾收场。

---

我们尝试过几次重启，但都因各种原因未能成功。直到 2022 年 9 月 14 日，我们正式在 Minecraft 1.19.2 版本上重新开坑，命名为 **illusion**（v0.3.0）。

这一版本在机制设计上推倒重来，同时借鉴了 v0.2.0 的部分经验。例如不再额外开发血量机制，而是直接使用原版血条；取消倒地与上钩系统，转而改为“被击杀直接进入笼子”的方式，简化了逻辑、提升了节奏。

虽然期间也经历了长时间的搁置与重构，但历时三年，我们终于交出了令自己满意的作品。

## 地图设计

illusion 的地图设计非常巧妙，为了让每局游戏都有新鲜感，地图会根据一定的配置随机生成。

通过从预设好的模板中按照一定逻辑随机复制结构至游玩区域，以此达成地图内容的高度随机。

为此，我专门编写过一篇关于该机制的博客，感兴趣的可以看一看：

[Minecraft JE: 基于随机区块的地图生成设计 - illusion 的实现](https://blog.im0o.top/posts/da8bb269.html)

简单概括一下，就是在适用随机数生成器的情况下，通过预设的模板，随机生成地图。

![](https://image.im0o.top/2024/20241210155654.gif)

![](https://image.im0o.top/2024/20241210163351.png)

## 玩法设计

游戏分为 `逃生者` 和 `杀手` 两个阵营，每个阵营都有各自独特的角色。

逃生者需要完成至少 8 处供奉箱的供奉，将获得的蜡烛放入大门烛台中开启大门并逃脱

杀手则需要阻止逃生者完成逃脱，击杀并淘汰所有逃生者

## 供奉箱

供奉箱是 illusion 中非常重要的一个机制，也是该地图的特色之一。

场上一共存在 7 处供奉箱，向供奉箱内投入“铜钱”道具到一定数量后即可完成供奉

- 供奉进度达到 100% 后，离供奉箱较近的 1 名 逃生者 将获得 1 根蜡烛
- 该供奉箱将全图高亮一段时间
- 供奉箱进度达到 100% 后，在供奉箱周围一定范围内没有逃生者时将自动恢复，一段时间后重新变为可供奉状态，杀手靠近恢复中的供奉箱将使其恢复进度回退

- 铜钱刷新机制
    
    在玩家附近一定范围内刷新铜钱，存在一定时间后消失
    
    杀手附近的铜钱掉落物会自动消失

## 供奉速度

供奉速度与存活逃生者存在一定关系，当有人淘汰时，其余逃生者供奉速度会相对应得到提升。

每位玩家的供奉速度= 总供奉速度 /（总人数-淘汰人数）

## 大门

向大门的 2 个烛台各插入 4 根蜡烛（共 8 根/门）后，大门将进入开启状态

在开启中的大门烛台范围内站立至进度条结束后即可打开大门

杀手在范围内将使进度条回退

## 淘汰

逃生者被击杀后传送进 淘汰区域 的 笼子 中

在 笼子 中的逃生者将持续增长淘汰进度，分为 3 个阶段

- 1 阶段（第一次进入笼子）
- 2 阶段（淘汰进度高于 50%）
- 3 阶段（淘汰）

被救下的逃生者被击杀将直接进入下一阶段

## 足迹

逃生者在对局过程中会产生显眼的白色粒子效果痕迹

该痕迹仅会被杀手看到

逃生者蹲下时不会产生痕迹

- 实现原理
    
    每秒向站立状态的逃生者所在位置生成一个无效果 足迹标记 药水云，持续时间 5 秒
    
    并在所有 足迹标记 药水云处生成粒子效果
    
    在离玩家较近的 足迹标记 药水云处生成更多粒子效果'


## 准备阶段

玩家选择阵营、角色、技能后加入游戏，实现方式也很巧妙

逃生者和杀手都有一个准备区域，进入后会获得一个准备状态，记为已准备玩家

在准备区域会有一个悬浮字体，显示当前已准备玩家数量

在 Minecraft 原版中无法对悬浮字体（盔甲架的名称）进行插值/变量修改，所以理论上无法实现动态的已准备玩家数量显示

但我使用了告示牌的文本内容来实现了动态的文本显示，然后把告示牌的文本nbt复制到了悬浮字体上，以此实现了动态的已准备玩家数量显示

## 底层实现逻辑

这里写了整个局内玩法的核心逻辑，我实现了几种很重要的机制

1. 循环执行函数

2. 触发器

3. 计时器

### 循环执行函数

其中，循环执行函数的原理是使用 schedule 命令，在执行的函数里再调用自己，以此实现循环执行

### 触发器（Handler）

触发器(handler) 是 illusion 中非常重要，以至于可以说贯穿了整个地图的实现，几乎所有机制的实现都离不开触发器

我对游戏的所有局内机制/事件，都会调用预设好的触发器函数以触发需要执行的逻辑，这大大解耦了代码，使代码更加清晰

### 计时器

计时器是 illusion 中众多冷却技能的实现基础，几乎所有冷却技能都会使用计时器来实现

计时器的实现基于了循环执行函数和记分板，使用记分板记录剩余时间，从而实现冷却计时功能

## 玩家出生

玩家加入游戏后根据随机好的刷点进行出生

- 刷点原理
    
    从地图中随机选取一点作为参考点（bpoint）
    
    - 使参考点作为逃生者的其中一个刷点
    - 选取离参考点最远的 1 点作为杀手刷点
    - 选取离参考点 32 格以外 最近的 3 点作为逃生者的其他刷点

这些机制仅基于原版目标选择器实现，逻辑简洁却效果显著

## 结算

触发结算判定后，根据以下条件判断对局结算情况

- 【杀手胜利】淘汰逃生者大于逃脱逃生者数量，且场上无存活逃生者
- 【平局】淘汰逃生者等于逃脱逃生者数量，且场上无存活逃生者
- 【逃生者胜利】淘汰逃生者小于逃脱逃生者数量，且场上无存活逃生者

* 存活逃生者：在对局中，可以自由行动的逃生者

发生以下事件后触发结算判定

- 有逃生者被淘汰
- 有逃生者成功逃脱

## 传承技能

参考《黎明杀机》，角色初始拥有 3 个可传承技能

所有玩家可以从多个技能中自由选择，最多可携带 4 个技能参加对局

首次游玩角色后将解锁 技能传承，传承的技能可以在使用其他角色时携带使用

## 角色设计

截至 v0.4.3-beta 版本，illusion 更新了 4 位杀手和 8 位逃生者

每个杀手有独特的专属力量，这些能力让他们独特而致命

| 角色 | 类型 |
| --- | --- |
| illusion-疫医 | 杀手 |
| illusion-园丁 | 杀手 |
| illusion-哭泣天使 | 杀手 |
| illusion-猎手 | 杀手 |
| illusion-信徒 | 逃生者 |
| illusion-“顾问” | 逃生者 |
| illusion-运动员 | 逃生者 |
| illusion-赌徒 | 逃生者 |
| illusion-砖家 | 逃生者 |
| illusion-街溜子 | 逃生者 |
| illusion-风水师 | 逃生者 |
| illusion-护工 | 逃生者 |

## 教学模式

illusion 设计了非常详细的教学模式，帮助玩家快速上手，所有的机制都有详细的教学

![](https://upyun-uss-cdn.im0o.cn/illusion-images/2025-04-3011_19_50-ezgif.com-gif-to-webp-converter.webp)

![](https://upyun-uss-cdn.im0o.cn/illusion-images/2025-04-3011_21_43-ezgif.com-gif-to-webp-converter.webp)

![](https://upyun-uss-cdn.im0o.cn/illusion-images/2025-04-3011_29_55-ezgif.com-optiwebp.webp)

![](https://upyun-uss-cdn.im0o.cn/illusion-images/2025-04-3011_28_21-ezgif.com-webp-maker.webp)

![](https://upyun-uss-cdn.im0o.cn/illusion-images/2025-04-3011_32_35-ezgif.com-optiwebp.webp)

## 技能设计

技能设计是 illusion 中非常重要的一部分，每个角色都有独特的技能

技能设计基于了触发器，通过触发器来实现技能的释放

## 官网

illusion 的官网是我使用 Nuxt.js 开发的，使用了全屏视频作为首屏背景，并使用了一些动画效果来提升视觉效果

你可以在这里查看官网：

[illusion 官网](https://illusion.im0o.top)

## PV 视频

随着地图的更新，我制作了多期 PV 视频，视频内容以前半段 Minecraft 动画为主，后半段为地图/角色玩法介绍

<iframe 
  src="https://player.bilibili.com/player.html?bvid=BV1PSoRY7E9o&autoplay=0" 
  scrolling="no" 
  frameborder="no" 
  allowfullscreen="true" 
  width="100%" 
  height="500px">
</iframe>

<iframe 
  src="https://player.bilibili.com/player.html?bvid=BV14BGZzdEVU&autoplay=0" 
  scrolling="no" 
  frameborder="no" 
  allowfullscreen="true" 
  width="100%" 
  height="500px">
</iframe>

<iframe 
  src="https://player.bilibili.com/player.html?bvid=BV16pV4zbEhU&autoplay=0" 
  scrolling="no" 
  frameborder="no" 
  allowfullscreen="true" 
  width="100%" 
  height="500px">
</iframe>

## 未来设想

- Minestom 服务端版本计划
- 联动内容创作者推广（bilibili / 盒子地图平台）
- 商业化与小游戏平台合作可能性